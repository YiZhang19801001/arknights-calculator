# 明日方舟理智计算器 - 需求文档

## 1. 项目概述

### 1.1 项目背景
《明日方舟》是一款手机游戏，玩家扮演"博士"角色，通过消耗"理智"资源获取"声望"，达到一定声望后可升级。本项目旨在创建一个计算器，帮助玩家预测在特定游玩时间内可获得的总理智数量和升级情况。

### 1.2 项目目标
提供一个直观、易用的 Web 应用，让玩家能够：
- 输入游玩时间区间，自动计算可用理智
- 考虑自然恢复、升级奖励、额外获得等所有理智来源
- 模拟升级过程，展示详细的统计数据

### 1.3 目标用户
《明日方舟》玩家，需要规划游戏时间和资源使用的用户

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 时间输入
- **输入方式**：日期时间选择器（datetime picker）
- **输入项**：
  - 开始时间（start datetime）
  - 结束时间（end datetime）
- **验证规则**：
  - 两个时间都必须填写
  - 结束时间必须晚于开始时间
- **输出**：自动计算时间差（分钟、小时）

#### 2.1.2 额外理智输入
- **输入方式**：数字输入框
- **输入项**：额外获得的理智数量
- **来源说明**：邮件、商店购买、活动奖励等
- **验证规则**：
  - 必须为非负整数
  - 默认值为 0

#### 2.1.3 理智计算逻辑
- **初始理智**：127
- **自然恢复**：每 6 分钟恢复 1 理智
- **理智消耗**：1 理智 = 12 声望
- **升级机制**：
  - 达到当前等级所需声望后自动升级
  - 多余声望保留到下一等级
  - 升级奖励：获得新等级理智上限数量的理智

#### 2.1.4 升级数据
参照游戏内等级系统（Lv.1 - Lv.50）：
- 每个等级的理智上限
- 升级所需声望
- 累计声望阈值

### 2.2 结果展示

#### 2.2.1 时间统计
- 游玩时长（小时 + 分钟）

#### 2.2.2 理智统计
- 初始理智：127
- 自然恢复理智数
- 额外理智数
- 升级获得理智数
- **总可用理智**（以上四项之和）
- 计算公式展示

#### 2.2.3 升级信息
- 升级次数
- 最终等级
- 最终声望进度（当前声望/所需声望）

#### 2.2.4 升级记录
- 详细列表展示每次升级：
  - 升级到的等级
  - 获得的理智奖励
- 可滚动查看（最多显示高度限制）

### 2.3 交互功能

#### 2.3.1 输入验证
- 实时验证用户输入
- 错误提示（Alert 或提示框）

#### 2.3.2 计算触发
- 点击"开始计算"按钮触发
- 验证通过后执行计算并显示结果

## 3. 技术需求

### 3.1 技术栈
- **前端框架**：React
- **样式方案**：Tailwind CSS
- **图标库**：lucide-react

### 3.2 组件结构
- 单页面应用（SPA）
- 响应式设计（支持移动端和桌面端）

### 3.3 数据结构

#### 3.3.1 等级数据
```javascript
{
  level: number,        // 等级
  cap: number,          // 理智上限
  reqReputation: number,// 升级所需声望
  totalReputation: number // 累计声望
}
```

#### 3.3.2 升级记录
```javascript
{
  level: number,        // 升级到的等级
  sanityReward: number, // 获得的理智
  reputation: number    // 升级后剩余声望
}
```

#### 3.3.3 计算结果
```javascript
{
  hours: string,                  // 游玩小时数
  totalMinutes: number,           // 总分钟数
  naturalRegen: number,           // 自然恢复理智
  extraSanity: number,            // 额外理智
  totalSanityUsed: number,        // 总可用理智
  finalLevel: number,             // 最终等级
  finalReputation: string,        // 最终声望
  levelUps: Array,                // 升级记录
  totalSanityFromLevelUp: number  // 升级总奖励
}
```

### 3.4 算法逻辑

#### 计算流程
1. 获取输入参数（开始/结束时间、额外理智）
2. 计算时间差（分钟）
3. 计算自然恢复理智 = floor(总分钟 / 6)
4. 初始化可用理智 = 127 + 自然恢复 + 额外理智
5. 模拟理智消耗和升级过程：
   - 循环使用理智直到耗尽
   - 每使用 1 理智获得 12 声望
   - 检查是否达到升级条件
   - 升级时扣除所需声望，保留多余声望
   - 获得升级奖励理智并加入可用理智池
6. 记录所有升级和最终状态
7. 返回计算结果

## 4. UI/UX 需求

### 4.1 设计风格
- 主题：深色科技风格（符合游戏氛围）
- 配色：蓝色、紫色渐变背景，卡片式布局
- 视觉效果：磨砂玻璃效果、柔和阴影

### 4.2 布局结构
- 顶部：标题 + 图标
- 中部：输入区域
  - 开始/结束时间（横向排列，桌面端）
  - 额外理智输入
  - 计算按钮
- 底部：结果展示区域
  - 时间统计卡片
  - 理智统计卡片（网格布局）
  - 升级记录卡片（可滚动列表）

### 4.3 响应式设计
- 桌面端：双列布局
- 移动端：单列布局，自适应宽度

### 4.4 用户反馈
- 输入验证错误提示
- 计算按钮 hover 效果
- 结果区域平滑展示

## 5. 游戏规则参考

### 5.1 理智系统
- 初始理智：127
- 恢复速率：6 分钟/1 理智
- 消耗转化：1 理智 = 12 声望

### 5.2 升级系统
- 等级范围：Lv.1 - Lv.50
- 升级方式：累计声望达到要求自动升级
- 升级奖励：获得新等级理智上限数量的理智
- 理智上限：
  - Lv.1: 127
  - Lv.2: 129
  - ...
  - Lv.50: 168

### 5.3 声望要求
- Lv.1 → Lv.2: 500 声望
- Lv.2 → Lv.3: 800 声望
- ...
- Lv.49 → Lv.50: 8400 声望

## 6. 非功能需求

### 6.1 性能要求
- 计算响应时间 < 1 秒
- 页面加载时间 < 3 秒

### 6.2 兼容性
- 支持现代浏览器（Chrome, Firefox, Safari, Edge）
- 支持移动端浏览器

### 6.3 可用性
- 界面直观易懂
- 操作流程简单
- 错误提示明确

## 7. 未来扩展

### 7.1 可能的功能增强
- 保存/加载计算历史
- 预设常见游玩时长模板
- 理智消耗规划建议
- 导出计算结果
- 多语言支持

### 7.2 数据更新
- 当游戏更新等级系统时，更新等级数据表

## 8. 项目信息

- **版本**：v1.0
- **最后更新**：2025-11-01
- **文档状态**：已完成
- **开发语言**：JavaScript / TypeScript
- **框架**：React